{"id":"guesthouseosaka-04t","title":"Simplify component interfaces","description":"After tests pass: Extract AmenityItem, simplify optional chaining with guaranteed shapes, extract THEME_COLORS to utility","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:56.403022+01:00","created_by":"melkir","updated_at":"2025-12-30T02:18:04.665865+01:00","closed_at":"2025-12-30T02:18:04.665865+01:00","close_reason":"Closed","labels":["refactor"],"dependencies":[{"issue_id":"guesthouseosaka-04t","depends_on_id":"guesthouseosaka-ksb","type":"blocks","created_at":"2025-12-30T01:26:56.405772+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-04t","depends_on_id":"guesthouseosaka-tj1","type":"blocks","created_at":"2025-12-30T01:26:56.406909+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-04t","depends_on_id":"guesthouseosaka-6xt","type":"blocks","created_at":"2025-12-30T01:26:56.407802+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-093","title":"Test MoveInForm component","description":"Create components/forms/__tests__/move-in-form.test.tsx with 7 tests: card, fields, validation, error focus, reset","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:40.311771+01:00","created_by":"melkir","updated_at":"2025-12-30T01:51:35.536404+01:00","closed_at":"2025-12-30T01:51:35.536404+01:00","close_reason":"Closed","labels":["forms","testing"],"dependencies":[{"issue_id":"guesthouseosaka-093","depends_on_id":"guesthouseosaka-ro9","type":"blocks","created_at":"2025-12-30T01:26:40.31317+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-0aq","title":"Update page components to transform data at page level","description":"Update app/[locale]/[house]/page.tsx and app/[locale]/contact/[slug]/page.tsx to use transformer functions. Pass clean props to components while preserving _id/_type for Visual Editing.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:50:10.419523+01:00","created_by":"melkir","updated_at":"2025-12-29T23:05:29.752899+01:00","closed_at":"2025-12-29T23:05:29.752899+01:00","close_reason":"Closed","labels":["pages","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-0aq","depends_on_id":"guesthouseosaka-ml8","type":"blocks","created_at":"2025-12-29T22:50:10.422009+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-0aq","depends_on_id":"guesthouseosaka-8j4","type":"blocks","created_at":"2025-12-29T22:50:10.423264+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-0aq","depends_on_id":"guesthouseosaka-kkv","type":"blocks","created_at":"2025-12-29T22:50:10.424189+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-0o7","title":"Add featured image field to house schema","description":"Add optional featured image field to house document that displays as the first image on:\n- MobileHeroImage component\n- ImageBlockGallery component (house page only)\n\nNo changes on gallery page (/[house]/gallery).\n\nSteps:\n- [ ] Add `featuredImage` field to house schema (optional image with i18n alt)\n- [ ] Update GROQ query to include featuredImage\n- [ ] Update MobileHeroImage to use featuredImage if available\n- [ ] Update ImageBlockGallery to prepend featuredImage\n- [ ] Run typegen","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T01:42:35.151328+09:00","updated_at":"2025-12-24T20:11:10.453919+09:00","closed_at":"2025-12-24T20:11:10.453919+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-0r6","title":"Migrate FAQ phone notice and numbers to Sanity","description":"Make phone-related content editable in Sanity:\n\n1. Phone notice: 'We may not be able to answer calls at certain times.'\n   - Currently hardcoded in translations (FAQCard.subtext)\n   - Add to faq-page schema as editable field\n\n2. Phone numbers: Link to house documents\n   - Currently in translations (useHousePhones hook)\n   - Query from house.phone instead\n\nFiles:\n- sanity/schemaTypes/documents/faq-page.ts\n- app/[locale]/faq/(components)/faq-card.tsx\n- app/[locale]/faq/(components)/faq-contact-table.tsx\n- hooks/use-house-phones.ts (to be removed after)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T10:28:21.451334+09:00","updated_at":"2025-12-28T09:48:37.516722+09:00","closed_at":"2025-12-28T09:48:37.516722+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-0sk","title":"Test useSwipeToClose hook","description":"Create hooks/__tests__/use-swipe-to-close.test.ts with 7 tests: vertical swipe, threshold, state reset","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:02.675066+01:00","created_by":"melkir","updated_at":"2025-12-30T01:32:59.573827+01:00","closed_at":"2025-12-30T01:32:59.573827+01:00","close_reason":"Closed","labels":["foundation","testing"]}
{"id":"guesthouseosaka-101","title":"Update house components to consume Sanity data","description":"Phase B.2 - House Components:\n- Update `house-about.tsx` to use Sanity query\n- Update `house-amenities.tsx` to use Sanity query\n- Update `house-pricing.tsx` to use Sanity query\n- Update `house-location.tsx` to use Sanity query\n- Update `house-building.tsx` to use Sanity query\n\nFiles in: `components/house/`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T20:26:19.769468+09:00","updated_at":"2025-12-21T20:49:45.135162+09:00","closed_at":"2025-12-21T20:49:45.135162+09:00","close_reason":"Closed","dependencies":[{"issue_id":"guesthouseosaka-101","depends_on_id":"guesthouseosaka-b6n","type":"blocks","created_at":"2025-12-21T20:27:32.030145+09:00","created_by":"daemon","metadata":"{}"}]}
{"id":"guesthouseosaka-10n","title":"Test gallery utility functions","description":"Create lib/__tests__/gallery.test.ts with 10 tests: featuredToGalleryImage, getImageIndex, groupGalleryByCategory","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:09.254523+01:00","created_by":"melkir","updated_at":"2025-12-30T01:33:45.760691+01:00","closed_at":"2025-12-30T01:33:45.760691+01:00","close_reason":"Closed","labels":["gallery","testing"],"dependencies":[{"issue_id":"guesthouseosaka-10n","depends_on_id":"guesthouseosaka-6f2","type":"blocks","created_at":"2025-12-30T01:26:09.257487+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-16g","title":"Refactor gallery query to server-side GROQ","description":"Move gallery image grouping from client-side hook to server-side GROQ query.\n\nCurrent: Client-side hook groups images by category\nTarget: GROQ query returns nested structure grouped by category\n\nReturn structure:\n```typescript\n{\n  category: { key, label, image },\n  images: [{ asset, alt, ... }]\n}[]\n```\n\nSteps:\n- [ ] Create new GROQ query with nested category grouping\n- [ ] Update gallery page to use server-side query\n- [ ] Remove client-side grouping hook if no longer needed\n- [ ] Run typegen","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T01:42:45.919974+09:00","updated_at":"2025-12-26T04:53:45.417999+09:00","closed_at":"2025-12-26T04:53:45.417999+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-1ri","title":"Extract useSwipeToClose hook","description":"Create hooks/use-swipe-to-close.ts - extract touch handling logic from gallery-modal.tsx into reusable hook","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:59:00.933983+09:00","updated_at":"2025-12-29T08:10:47.53006+09:00","closed_at":"2025-12-29T08:10:47.53006+09:00","close_reason":"Closed","labels":["dry","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-1ri","depends_on_id":"guesthouseosaka-blp","type":"blocks","created_at":"2025-12-29T04:59:32.725754+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-1sw","title":"Test HouseAbout component","description":"Create components/house/__tests__/house-about.test.tsx with 6 tests: heading, PortableText, HouseBuilding integration","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:17.897175+01:00","created_by":"melkir","updated_at":"2025-12-30T01:43:04.308408+01:00","closed_at":"2025-12-30T01:43:04.308408+01:00","close_reason":"Closed","labels":["house","testing"]}
{"id":"guesthouseosaka-225","title":"Set up Vitest unit testing infrastructure","description":"Install vitest, testing-library, jsdom. Create vitest.config.ts and vitest.setup.ts with next-intl mocks. Add test scripts to package.json.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:49:26.423471+01:00","created_by":"melkir","updated_at":"2025-12-29T22:55:19.739048+01:00","closed_at":"2025-12-29T22:55:19.739048+01:00","close_reason":"Closed","labels":["infrastructure","testing"]}
{"id":"guesthouseosaka-2ti","title":"Enable gallery image reordering within categories","description":"Currently images maintain array position order within categories.\n\n- Drag-and-drop already works in Sanity Studio for arrays - use array position ordering\n- Avoid adding explicit order field - rely on array position\n\nFiles:\n- sanity/schemaTypes/objects/gallery-image.ts\n- sanity/lib/queries.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T10:27:41.743808+09:00","updated_at":"2025-12-28T09:48:37.707584+09:00","closed_at":"2025-12-28T09:48:37.707584+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-3kb","title":"Test useMobile hook","description":"Create hooks/__tests__/use-mobile.test.ts with 5 tests: SSR-safe, resize events, cleanup","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:02.539701+01:00","created_by":"melkir","updated_at":"2025-12-30T01:32:59.572379+01:00","closed_at":"2025-12-30T01:32:59.572379+01:00","close_reason":"Closed","labels":["foundation","testing"]}
{"id":"guesthouseosaka-3lx","title":"Test HouseLocation component","description":"Create components/house/__tests__/house-location.test.tsx with 7 tests: lazy-loaded map, modal, coordinate validation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:18.029091+01:00","created_by":"melkir","updated_at":"2025-12-30T01:43:53.055305+01:00","closed_at":"2025-12-30T01:43:53.055305+01:00","close_reason":"Closed","labels":["house","testing"]}
{"id":"guesthouseosaka-3xt","title":"Fix GROQ query typegen: replace l() helper with inline coalesce","description":"The helper function `l(field)` in `sanity/lib/queries.ts` breaks automatic type generation from `defineQuery()`.\n\n**Problem:**\n- Template literal interpolation with the `l()` helper prevents TypeScript from inferring the correct return types\n- `bun run typegen` cannot statically analyze the query structure\n\n**Solution:**\n- Replace all `${l('fieldName')}` calls with inline `coalesce(fieldName[_key == $locale][0].value, fieldName[_key == \"en\"][0].value)`\n- Remove the `l()` helper function\n- Run `bun run typegen` to verify types are correctly inferred\n\n**Files:**\n- `sanity/lib/queries.ts`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T23:27:53.067732+09:00","updated_at":"2025-12-22T23:30:37.743357+09:00","closed_at":"2025-12-22T23:30:37.743357+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-4b9","title":"Test TourForm component","description":"Create components/forms/__tests__/tour-form.test.tsx with 7 tests: card, fields, validation, error focus, reset","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:40.155284+01:00","created_by":"melkir","updated_at":"2025-12-30T01:51:35.505325+01:00","closed_at":"2025-12-30T01:51:35.505325+01:00","close_reason":"Closed","labels":["forms","testing"],"dependencies":[{"issue_id":"guesthouseosaka-4b9","depends_on_id":"guesthouseosaka-ro9","type":"blocks","created_at":"2025-12-30T01:26:40.156392+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-4bb","title":"E2E: Form submission tests","description":"Test all 3 forms (contact, tour, move-in): validation errors display, privacy checkbox required, successful submission shows toast, error handling works","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:03.131613+09:00","updated_at":"2025-12-29T06:02:39.847765+09:00","closed_at":"2025-12-29T06:02:39.847765+09:00","close_reason":"Closed","labels":["e2e","testing"],"dependencies":[{"issue_id":"guesthouseosaka-4bb","depends_on_id":"guesthouseosaka-m97","type":"blocks","created_at":"2025-12-29T04:58:26.014989+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-4hc","title":"Enable Visual Editing for FAQ Building Facts","description":"The 'How many floors and rooms' FAQ item is hardcoded in faq-accordion.tsx.\n\n- Currently displays data from house.building (rooms, floors)\n- Add data-sanity attributes to link to corresponding house documents\n- Allow clicking to edit the building facts in Sanity Studio\n\nFiles:\n- app/[locale]/faq/(components)/faq-accordion.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T10:27:48.311237+09:00","updated_at":"2025-12-26T19:29:02.461457+09:00","closed_at":"2025-12-26T19:29:02.461457+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-5fs","title":"Enable array reordering for Visual Editing","description":"Add Visual Editing support for reordering array items using `useOptimistic` hook pattern (see `hooks/use-optimistic.ts` and `components/collection.tsx`).\n\nArrays to support:\n- [ ] `house.about.highlights` - About section highlights\n- [ ] `house.amenities` - Amenities list (per house, within category groups)\n- [ ] `house.gallery` - Gallery images (within each category)\n- [ ] `house.pricing.notes[].items` - Pricing note items\n\nPattern:\n```typescript\nconst [items, attr] = useOptimistic(data, 'fieldName')\n\u003cdiv data-sanity={attr.list()}\u003e\n  {items?.map(item =\u003e (\n    \u003cdiv key={item._key} data-sanity={attr.item(item._key)} /\u003e\n  ))}\n\u003c/div\u003e\n```\n\nNote: Gallery reordering depends on gallery query refactor (16g).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T01:42:57.959436+09:00","updated_at":"2025-12-23T01:43:18.114405+09:00","closed_at":"2025-12-23T01:43:18.114405+09:00","close_reason":"Duplicate - use bx9 instead"}
{"id":"guesthouseosaka-5lv","title":"Run knip, lint, and format for final cleanup","description":"Run bun run knip to detect unused exports, bun lint --fix, bunx prettier --write . for final cleanup","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-29T04:59:08.883072+09:00","updated_at":"2025-12-29T08:11:50.191842+09:00","closed_at":"2025-12-29T08:11:50.191842+09:00","close_reason":"Closed","labels":["cleanup","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-5lv","depends_on_id":"guesthouseosaka-p0l","type":"blocks","created_at":"2025-12-29T04:59:32.762356+09:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-5lv","depends_on_id":"guesthouseosaka-nfx","type":"blocks","created_at":"2025-12-29T04:59:32.801108+09:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-5lv","depends_on_id":"guesthouseosaka-8lj","type":"blocks","created_at":"2025-12-29T04:59:32.840417+09:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-5lv","depends_on_id":"guesthouseosaka-7so","type":"blocks","created_at":"2025-12-29T04:59:32.878729+09:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-5lv","depends_on_id":"guesthouseosaka-m3k","type":"blocks","created_at":"2025-12-29T04:59:32.915234+09:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-5lv","depends_on_id":"guesthouseosaka-1ri","type":"blocks","created_at":"2025-12-29T04:59:32.954968+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-5lw","title":"Update gallery components to consume Sanity data","description":"Phase B.3 - Gallery Components:\n- Update `house-gallery-client.tsx` to fetch images from Sanity\n- Update `image-block-gallery.tsx` to use Sanity images\n- Remove JSON-based image storage dependency\n\nFiles in: `components/gallery/`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T20:26:26.338751+09:00","updated_at":"2025-12-21T21:05:14.163457+09:00","closed_at":"2025-12-21T21:05:14.163457+09:00","close_reason":"Closed","dependencies":[{"issue_id":"guesthouseosaka-5lw","depends_on_id":"guesthouseosaka-b6n","type":"blocks","created_at":"2025-12-21T20:27:32.198339+09:00","created_by":"daemon","metadata":"{}"}]}
{"id":"guesthouseosaka-5tm","title":"Migrate useHouseLabels hook to Sanity data","description":"Replace the useHouseLabels() hook with Sanity house data (title, caption, summary). Components using this hook (gallery-modal-wrapper.tsx, gallery-modal.tsx, forms/index.tsx) already receive house data from Sanity, so the hook can be replaced with props or direct Sanity queries. After migration, remove the useHouseLabels namespace from translations and delete the hook.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T23:30:28.063319+09:00","updated_at":"2025-12-28T23:52:45.459169+09:00","closed_at":"2025-12-28T23:52:45.459169+09:00","close_reason":"Migrated useHouseLabels hook to Sanity data. Gallery components now receive title as prop from server components. Forms receive houseTitles from housesTitlesQuery. Deleted hook and removed translations."}
{"id":"guesthouseosaka-6f2","title":"Extend mock factory with gallery and form mocks","description":"Add createGalleryItem, createSanityImage, createGalleryCategory, createCategorizedItem, and form data mocks to lib/transforms/__tests__/mocks.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:25:53.75439+01:00","created_by":"melkir","updated_at":"2025-12-30T01:31:00.922467+01:00","closed_at":"2025-12-30T01:31:00.922467+01:00","close_reason":"Closed","labels":["foundation","testing"]}
{"id":"guesthouseosaka-6nk","title":"Test useFormSubmit hook","description":"Create components/forms/__tests__/use-form-submit.test.ts with 8 tests: focus invalid, type mapping, toast notifications, redirect","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:39.876383+01:00","created_by":"melkir","updated_at":"2025-12-30T01:47:58.003094+01:00","closed_at":"2025-12-30T01:47:58.003094+01:00","close_reason":"Closed","labels":["forms","testing"],"dependencies":[{"issue_id":"guesthouseosaka-6nk","depends_on_id":"guesthouseosaka-ro9","type":"blocks","created_at":"2025-12-30T01:26:39.879386+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-6pu","title":"Responsive FAQ extra costs: table on desktop, swipeable cards on mobile","description":"Current table works well on desktop but is hard to read on mobile.\n\n**Solution:**\n- Desktop: Keep current table layout\n- Mobile: Swipeable cards (one per house) with cost categories listed\n\n**Sanity Schema:**\nAdd `extraCosts` array to house document:\n- category: string (deposit, common-fees, utility-fees, water-bill, laundromat, drying-machine, internet)\n- value: internationalizedArrayString (e.g., \"¬•30,000\", \"Free\", \"¬•12,000/month\")\n\n**Frontend:**\n- Use existing table component for desktop (md+ breakpoint)\n- New swipeable card carousel for mobile (\u003cmd breakpoint)\n- Query houses with extraCosts, render per-house cards with accent colors\n\n**Files:**\n- sanity/schemaTypes/documents/house.ts (add extraCosts field)\n- app/[locale]/faq/(components)/faq-extra-costs-table.tsx (desktop)\n- app/[locale]/faq/(components)/faq-extra-costs-cards.tsx (new, mobile)\n- Seed extraCosts data for each house","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T10:27:54.609352+09:00","updated_at":"2025-12-28T20:12:18.746159+09:00","closed_at":"2025-12-28T20:12:18.746159+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-6xt","title":"Test HousePageContent component","description":"Create components/house/__tests__/house-page-content.test.tsx with 8 tests: data transformation orchestration, theme colors, sub-component rendering","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:50.238148+01:00","created_by":"melkir","updated_at":"2025-12-30T02:12:56.629076+01:00","closed_at":"2025-12-30T02:12:56.629076+01:00","close_reason":"Closed","labels":["house","testing"],"dependencies":[{"issue_id":"guesthouseosaka-6xt","depends_on_id":"guesthouseosaka-ksb","type":"blocks","created_at":"2025-12-30T01:26:50.24105+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-6xt","depends_on_id":"guesthouseosaka-1sw","type":"blocks","created_at":"2025-12-30T01:26:50.242183+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-6xt","depends_on_id":"guesthouseosaka-3lx","type":"blocks","created_at":"2025-12-30T01:26:50.243053+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-7cg","title":"Define component interfaces in lib/types/components.ts","description":"Create explicit interfaces for components: HouseAboutData, BuildingData, LocationData, PricingRow, AmenityData, FormFieldConfig, ContactFormData, ImageData. Follow the pattern from lib/gallery.ts.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:49:33.589676+01:00","created_by":"melkir","updated_at":"2025-12-29T22:55:19.74094+01:00","closed_at":"2025-12-29T22:55:19.74094+01:00","close_reason":"Closed","labels":["refactor","types"]}
{"id":"guesthouseosaka-7so","title":"Refactor forms to use shared components","description":"Update contact-form.tsx, tour-form.tsx, move-in-form.tsx to use useFormSubmit, PrivacyPolicyField, and FormCard. Expected reduction: ~200 lines total.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:59:00.468701+09:00","updated_at":"2025-12-29T08:06:10.056768+09:00","closed_at":"2025-12-29T08:06:10.056768+09:00","close_reason":"Closed","labels":["dry","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-7so","depends_on_id":"guesthouseosaka-lsm","type":"blocks","created_at":"2025-12-29T04:59:32.537889+09:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-7so","depends_on_id":"guesthouseosaka-b9u","type":"blocks","created_at":"2025-12-29T04:59:32.575749+09:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-7so","depends_on_id":"guesthouseosaka-u3x","type":"blocks","created_at":"2025-12-29T04:59:32.612564+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-8j4","title":"Refactor house components to use clean interfaces","description":"Refactor house-about.tsx, house-building.tsx, house-pricing.tsx, house-amenities.tsx to use component interfaces instead of Pick\u003cNonNullable\u003cQueryResult\u003e\u003e patterns.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:49:56.037369+01:00","created_by":"melkir","updated_at":"2025-12-29T23:02:27.537859+01:00","closed_at":"2025-12-29T23:02:27.537859+01:00","close_reason":"Closed","labels":["components","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-8j4","depends_on_id":"guesthouseosaka-l0s","type":"blocks","created_at":"2025-12-29T22:49:56.040033+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-8lj","title":"Update contact \u0026 FAQ pages with empty states","description":"Replace silent 'return null' with \u003cPageEmptyState /\u003e in app/[locale]/contact/page.tsx and app/[locale]/faq/page.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:44.042133+09:00","updated_at":"2025-12-29T06:08:50.341341+09:00","closed_at":"2025-12-29T06:08:50.341341+09:00","close_reason":"Closed","labels":["refactor","ux"],"dependencies":[{"issue_id":"guesthouseosaka-8lj","depends_on_id":"guesthouseosaka-lg7","type":"blocks","created_at":"2025-12-29T04:59:32.385499+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-aap","title":"Make page action buttons configurable from Sanity","description":"Allow reordering and text editing of mail/phone/faq buttons on pages.\n\nCurrently hardcoded in layout.tsx files with:\n- Icons: MailIcon, PhoneIcon, BookTextIcon\n- Text from translations\n- Fixed order per page\n\nImplementation:\n- Create schema for page actions (icon, label, href, variant)\n- Add to page schemas (contact, faq, etc.)\n- Update layouts to consume from Sanity\n\nFiles:\n- New schema type for page actions\n- sanity/schemaTypes/documents/contact-page.ts\n- sanity/schemaTypes/documents/faq-page.ts\n- app/[locale]/contact/layout.tsx\n- app/[locale]/faq/layout.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T10:28:29.388417+09:00","updated_at":"2025-12-28T09:48:37.325776+09:00","closed_at":"2025-12-28T09:48:37.325776+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-aex","title":"Test groupByCategory utility","description":"Create lib/utils/__tests__/group-by-category.test.ts with 8 tests: grouping, null handling, sorting by order","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:02.401419+01:00","created_by":"melkir","updated_at":"2025-12-30T01:32:59.569068+01:00","closed_at":"2025-12-30T01:32:59.569068+01:00","close_reason":"Closed","labels":["foundation","testing"],"dependencies":[{"issue_id":"guesthouseosaka-aex","depends_on_id":"guesthouseosaka-6f2","type":"blocks","created_at":"2025-12-30T01:26:02.404135+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-b6n","title":"Create GROQ queries for new document types","description":"Phase B.1 - Queries:\n- Create `settingsQuery` for global settings\n- Enhance `houseQuery` with gallery, amenities, pricing, location\n- Create `faqPageQuery` for FAQ page\n- Create `contactPageQuery` for contact page\n\nFile: `sanity/lib/queries.ts`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T20:26:11.983797+09:00","updated_at":"2025-12-21T20:36:36.356126+09:00","closed_at":"2025-12-21T20:36:36.356126+09:00","close_reason":"Closed","dependencies":[{"issue_id":"guesthouseosaka-b6n","depends_on_id":"guesthouseosaka-e9p","type":"blocks","created_at":"2025-12-21T20:27:31.801388+09:00","created_by":"daemon","metadata":"{}"}]}
{"id":"guesthouseosaka-b89","title":"Enable amenity reordering within houses","description":"Currently amenities are sorted by category.order then array position. Add ability to reorder amenities within a house.\n\n- Drag-and-drop already works in Sanity arrays - use array position ordering\n- Avoid adding explicit order field - rely on array position\n\nFiles:\n- sanity/schemaTypes/objects/house-amenity.ts\n- sanity/lib/queries.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T10:27:35.366323+09:00","updated_at":"2025-12-28T09:48:37.898698+09:00","closed_at":"2025-12-28T09:48:37.898698+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-b9u","title":"Extract PrivacyPolicyField component","description":"Create components/forms/privacy-policy-field.tsx - reusable checkbox with LegalNoticeDialog integration, used by all 3 forms","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:59:00.160541+09:00","updated_at":"2025-12-29T07:53:18.710601+09:00","closed_at":"2025-12-29T07:53:18.710601+09:00","close_reason":"Closed","labels":["dry","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-b9u","depends_on_id":"guesthouseosaka-4bb","type":"blocks","created_at":"2025-12-29T04:59:32.461742+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-blp","title":"E2E: Gallery modal tests","description":"Test modal opens from gallery, carousel navigation works (arrows, keyboard), swipe to close works, modal closes properly","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:02.976022+09:00","updated_at":"2025-12-29T06:02:39.845111+09:00","closed_at":"2025-12-29T06:02:39.845111+09:00","close_reason":"Closed","labels":["e2e","testing"],"dependencies":[{"issue_id":"guesthouseosaka-blp","depends_on_id":"guesthouseosaka-m97","type":"blocks","created_at":"2025-12-29T04:58:25.972619+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-bls","title":"E2E: Homepage baseline tests","description":"Test homepage loads, collection cards display images correctly, gallery wall renders all 6 images","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:02.504547+09:00","updated_at":"2025-12-29T05:44:59.157307+09:00","closed_at":"2025-12-29T05:44:59.157307+09:00","close_reason":"Closed","labels":["e2e","testing"],"dependencies":[{"issue_id":"guesthouseosaka-bls","depends_on_id":"guesthouseosaka-m97","type":"blocks","created_at":"2025-12-29T04:58:25.844273+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-bu2","title":"Test ContactForm component","description":"Create components/forms/__tests__/contact-form.test.tsx with 7 tests: card, fields, validation, error focus, reset","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:40.019245+01:00","created_by":"melkir","updated_at":"2025-12-30T01:50:00.267356+01:00","closed_at":"2025-12-30T01:50:00.267356+01:00","close_reason":"Closed","labels":["forms","testing"],"dependencies":[{"issue_id":"guesthouseosaka-bu2","depends_on_id":"guesthouseosaka-ro9","type":"blocks","created_at":"2025-12-30T01:26:40.020331+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-cy5","title":"Test HouseGalleryClient component","description":"Create components/gallery/__tests__/house-gallery-client.test.tsx with 9 tests: category thumbnails, scroll-into-view, store integration","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:29.678913+01:00","created_by":"melkir","updated_at":"2025-12-30T01:52:44.058861+01:00","closed_at":"2025-12-30T01:52:44.058861+01:00","close_reason":"Closed","labels":["gallery","testing"],"dependencies":[{"issue_id":"guesthouseosaka-cy5","depends_on_id":"guesthouseosaka-10n","type":"blocks","created_at":"2025-12-30T01:26:29.680133+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-d86","title":"Migrate SEO and JSON-LD to use Sanity data","description":"Update SEO metadata and JSON-LD structured data to use Sanity instead of hardcoded values and next-intl.\n\n## Currently using Sanity ‚úÖ\n- House page JSON-LD: title, description, phone, address, building (rooms)\n\n## Still using next-intl or hardcoded ‚ùå\n\n| Data | Current Source | Should Use |\n|------|----------------|------------|\n| Site name | `t('manifest.name')` | `settings.brandName` |\n| Site description | `t('manifest.description')` | Missing - add to settings |\n| Organization legal name | Hardcoded | `settings.companyName` |\n| Organization email | Hardcoded | Missing - add to settings |\n| Social links (sameAs) | Hardcoded `urls.socials` | `settings.socialLinks` |\n| House SEO title/summary | `getHouseLabel()` next-intl | `house.title`, `house.description` |\n| House phone (org JSON-LD) | `getHousePhoneLabel()` next-intl | `house.phone` |\n\n## Missing fields to add to Settings schema\n- [ ] `email` - Contact email for Organization schema\n- [ ] `siteDescription` - Site meta description (i18n)\n- [ ] `keywords` (optional) - SEO keywords array\n\n## Steps\n- [ ] Add missing fields to Settings schema\n- [ ] Update settingsQuery to include new fields\n- [ ] Update root layout to fetch settings and use for JSON-LD\n- [ ] Update root layout generateMetadata to use settings\n- [ ] Update house layout generateMetadata to use Sanity data\n- [ ] Remove `getHouseLabel()` and `getHousePhoneLabel()` helpers\n- [ ] Run typegen","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T01:54:19.734589+09:00","updated_at":"2025-12-25T19:32:05.624453+09:00","closed_at":"2025-12-25T19:32:05.624453+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-d8c","title":"E2E: House page baseline tests","description":"Test house page loads, gallery renders with 5+ images, amenities display grouped by category, pricing section shows, location map loads","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:02.660258+09:00","updated_at":"2025-12-29T06:02:39.840781+09:00","closed_at":"2025-12-29T06:02:39.840781+09:00","close_reason":"Closed","labels":["e2e","testing"],"dependencies":[{"issue_id":"guesthouseosaka-d8c","depends_on_id":"guesthouseosaka-m97","type":"blocks","created_at":"2025-12-29T04:58:25.886652+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-dcq","title":"Seed taxonomy data in Sanity","description":"Phase C.1 - Seed Taxonomies:\n- Create 7 gallery categories (room, common-spaces, facilities, etc.)\n- Create 7 amenity categories (internet_climate, kitchen_dining, etc.)\n- Create ~25 amenities with icons and category references\n\nUse Sanity MCP tools for content operations.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T20:26:34.778507+09:00","updated_at":"2025-12-22T23:16:28.359179+09:00","closed_at":"2025-12-22T23:16:28.359179+09:00","close_reason":"Closed","dependencies":[{"issue_id":"guesthouseosaka-dcq","depends_on_id":"guesthouseosaka-e9p","type":"blocks","created_at":"2025-12-21T20:27:32.368099+09:00","created_by":"daemon","metadata":"{}"}]}
{"id":"guesthouseosaka-e9p","title":"Deploy Sanity schema and run typegen","description":"Phase A completion:\n- Run `bunx sanity schema deploy` to deploy schema to Content Lake\n- Run `bun run typegen` to regenerate TypeScript types\n- Verify types are generated correctly","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T20:26:04.087434+09:00","updated_at":"2025-12-21T20:30:56.00111+09:00","closed_at":"2025-12-21T20:30:56.00111+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-f24","title":"Write unit tests for refactored components","description":"Create unit tests in components/house/__tests__/ and components/forms/__tests__/ using the new clean interfaces. Test with mocked data to verify components render correctly.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:50:16.974428+01:00","created_by":"melkir","updated_at":"2025-12-29T23:09:34.923299+01:00","closed_at":"2025-12-29T23:09:34.923299+01:00","close_reason":"Closed","labels":["components","testing"],"dependencies":[{"issue_id":"guesthouseosaka-f24","depends_on_id":"guesthouseosaka-225","type":"blocks","created_at":"2025-12-29T22:50:16.977572+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-f24","depends_on_id":"guesthouseosaka-0aq","type":"blocks","created_at":"2025-12-29T22:50:16.978774+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-gp6","title":"Create PageEmptyState component for manager feedback","description":"Create components/page-empty-state.tsx using existing Empty UI components. Shows helpful messages when Sanity content is missing (icon, title, description for managers).","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-29T04:58:43.730202+09:00","updated_at":"2025-12-29T06:08:50.334199+09:00","closed_at":"2025-12-29T06:08:50.334199+09:00","close_reason":"Closed","labels":["refactor","ux"],"dependencies":[{"issue_id":"guesthouseosaka-gp6","depends_on_id":"guesthouseosaka-tyv","type":"blocks","created_at":"2025-12-29T04:59:32.312293+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-gvo","title":"Create generic groupByCategory utility","description":"Create lib/utils/group-by-category.ts - generic function for grouping items by category, works for both gallery and amenities","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:59:00.623687+09:00","updated_at":"2025-12-29T07:33:59.348263+09:00","closed_at":"2025-12-29T07:33:59.348263+09:00","close_reason":"Closed","labels":["dry","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-gvo","depends_on_id":"guesthouseosaka-d8c","type":"blocks","created_at":"2025-12-29T04:59:32.650856+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-huw","title":"Migrate house content to Sanity","description":"Phase C.2 - House Content Migration\n\n‚úÖ COMPLETED:\n- Created seed script: `scripts/seed-house-content.ts`\n- Seeded all 3 houses (apple, lemon, orange) with:\n  - Caption (i18n: en, ja, fr)\n  - Building facts (rooms, floors, startingPrice)\n  - About section (description + highlights)\n  - Location (highlight, address, coordinates, stations, nearby)\n  - Pricing (rows + notes)\n  - Phone numbers (domestic + international)\n- Components already consume Sanity data (task 101)\n- Visual Editing support added for number fields (building facts)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T20:26:42.90329+09:00","updated_at":"2025-12-23T01:18:54.176284+09:00","closed_at":"2025-12-23T01:18:54.176284+09:00","close_reason":"Closed","dependencies":[{"issue_id":"guesthouseosaka-huw","depends_on_id":"guesthouseosaka-dcq","type":"blocks","created_at":"2025-12-21T20:27:32.536859+09:00","created_by":"daemon","metadata":"{}"},{"issue_id":"guesthouseosaka-huw","depends_on_id":"guesthouseosaka-101","type":"blocks","created_at":"2025-12-21T20:27:32.711682+09:00","created_by":"daemon","metadata":"{}"},{"issue_id":"guesthouseosaka-huw","depends_on_id":"guesthouseosaka-5lw","type":"blocks","created_at":"2025-12-21T20:27:32.877774+09:00","created_by":"daemon","metadata":"{}"}]}
{"id":"guesthouseosaka-je9","title":"Migrate FAQ and settings content to Sanity","description":"Phase C.3 - FAQ \u0026 Settings Migration\n\n‚úÖ COMPLETED:\n- Seed script exists: `scripts/seed-singleton-content.ts`\n- FAQ items seeded to Sanity (faqPage document)\n- Contact types seeded (contactPage document)\n- Site settings seeded (settings document)\n\n‚è≥ TODO - Update front-end to consume Sanity data:\n- [ ] FAQ page: Replace `useTranslations('FAQAccordion')` with Sanity query\n- [ ] Contact page: Fetch contact types from Sanity\n- [ ] Footer/layout: Fetch settings (company name, social links) from Sanity\n\nüìù NOTES:\n- `floors-and-rooms`: Already fetches building data from house documents\n- `extra-costs`: Uses dedicated component with static data (not migrated)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T20:26:48.925149+09:00","updated_at":"2025-12-25T17:52:19.960664+09:00","closed_at":"2025-12-25T17:52:19.960664+09:00","close_reason":"Closed","dependencies":[{"issue_id":"guesthouseosaka-je9","depends_on_id":"guesthouseosaka-dcq","type":"blocks","created_at":"2025-12-21T20:27:33.050451+09:00","created_by":"daemon","metadata":"{}"}]}
{"id":"guesthouseosaka-kkv","title":"Refactor form components to use clean interfaces","description":"Refactor contact-form.tsx, tour-form.tsx, move-in-form.tsx to use ContactFormData interface instead of NonNullable\u003cContactTypeQueryResult\u003e['fields'] pattern.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:50:03.050763+01:00","created_by":"melkir","updated_at":"2025-12-29T23:02:27.539343+01:00","closed_at":"2025-12-29T23:02:27.539343+01:00","close_reason":"Closed","labels":["components","forms","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-kkv","depends_on_id":"guesthouseosaka-l0s","type":"blocks","created_at":"2025-12-29T22:50:03.053601+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-ksb","title":"Test HouseAmenities component","description":"Create components/house/__tests__/house-amenities.test.tsx with 12 tests: featured filtering, responsive Dialog/Drawer, category grouping, note badges","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:17.76242+01:00","created_by":"melkir","updated_at":"2025-12-30T01:41:55.694341+01:00","closed_at":"2025-12-30T01:41:55.694341+01:00","close_reason":"Closed","labels":["house","testing"],"dependencies":[{"issue_id":"guesthouseosaka-ksb","depends_on_id":"guesthouseosaka-aex","type":"blocks","created_at":"2025-12-30T01:26:17.765337+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-ksb","depends_on_id":"guesthouseosaka-3kb","type":"blocks","created_at":"2025-12-30T01:26:17.766523+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-l0s","title":"Create data transformers in lib/transforms/","description":"Create lib/transforms/house.ts with toHouseAboutData, toLocationData, toPricingRows, toAmenityData functions. Create lib/transforms/form.ts for form data transformation. These convert Sanity query results to component interfaces.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:49:42.803506+01:00","created_by":"melkir","updated_at":"2025-12-29T22:57:21.300625+01:00","closed_at":"2025-12-29T22:57:21.300625+01:00","close_reason":"Closed","labels":["refactor","types"],"dependencies":[{"issue_id":"guesthouseosaka-l0s","depends_on_id":"guesthouseosaka-7cg","type":"blocks","created_at":"2025-12-29T22:49:42.807192+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-lg7","title":"Add PageEmptyState translations","description":"Add PageEmptyState namespace to messages/{en,ja,fr}.json with contact and faq title/description keys","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:43.886157+09:00","updated_at":"2025-12-29T06:08:50.338093+09:00","closed_at":"2025-12-29T06:08:50.338093+09:00","close_reason":"Closed","labels":["i18n","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-lg7","depends_on_id":"guesthouseosaka-gp6","type":"blocks","created_at":"2025-12-29T04:59:32.347923+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-lsm","title":"Extract shared form submission hook","description":"Create components/forms/use-form-submit.ts - extracts duplicated onSubmit, onSubmitInvalid, toast.promise pattern from all 3 forms","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:44.196691+09:00","updated_at":"2025-12-29T07:43:48.899148+09:00","closed_at":"2025-12-29T07:43:48.899148+09:00","close_reason":"Closed","labels":["dry","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-lsm","depends_on_id":"guesthouseosaka-4bb","type":"blocks","created_at":"2025-12-29T04:59:32.424826+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-m3k","title":"Update gallery and amenities to use generic groupByCategory","description":"Update lib/gallery.ts and components/house/house-amenities.tsx to use the new generic groupByCategory utility, eliminating duplicated logic","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:59:00.778838+09:00","updated_at":"2025-12-29T07:39:29.197689+09:00","closed_at":"2025-12-29T07:39:29.197689+09:00","close_reason":"Closed","labels":["dry","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-m3k","depends_on_id":"guesthouseosaka-gvo","type":"blocks","created_at":"2025-12-29T04:59:32.689469+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-m97","title":"Setup Playwright for E2E testing","description":"Install @playwright/test, create playwright.config.ts, add test scripts to package.json","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:02.331669+09:00","updated_at":"2025-12-29T05:36:03.768855+09:00","closed_at":"2025-12-29T05:36:03.768855+09:00","close_reason":"Closed","labels":["setup","testing"]}
{"id":"guesthouseosaka-ml8","title":"Refactor house-location components to use clean interfaces","description":"Refactor house-location.tsx and house-location-modal.tsx to use LocationData interface instead of triple-nested NonNullable types. This is priority 1 - most complex nesting.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:49:49.551965+01:00","created_by":"melkir","updated_at":"2025-12-29T23:02:27.536064+01:00","closed_at":"2025-12-29T23:02:27.536064+01:00","close_reason":"Closed","labels":["components","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-ml8","depends_on_id":"guesthouseosaka-l0s","type":"blocks","created_at":"2025-12-29T22:49:49.554695+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-msl","title":"Migrate Privacy Policy to Sanity Portable Text","description":"Current implementation uses complex translation structure in LegalNoticeDialog with:\n- Intro paragraphs\n- Multiple sections with titles, paragraphs, lists, closing text, details\n- Last updated date\n\nPortable Text is recommended because:\n- Supports headings, paragraphs, lists natively\n- Multi-language support via internationalizedArrayPortableText\n- Easier to edit than deeply nested translations\n- Can include last_updated date field separately\n\nFiles:\n- components/legal-notice-dialog.tsx\n- messages/*.json (LegalNoticeDialog namespace - to be removed after)\n- New schema: sanity/schemaTypes/documents/legal-notice.ts (or similar)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T10:29:20.674673+09:00","updated_at":"2025-12-28T09:48:37.132282+09:00","closed_at":"2025-12-28T09:48:37.132282+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-n09","title":"Migrate header navigation to use Sanity houses","description":"Header navigation items are hardcoded or using next-intl instead of Sanity house data. Update to fetch houses from Sanity for nav links.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T19:07:36.948468+09:00","updated_at":"2025-12-26T08:29:38.202772+09:00","closed_at":"2025-12-26T08:29:38.202772+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-nfx","title":"Fix image-block-gallery.tsx array bounds check","description":"Lines 143-148 access validGalleryImages[0] without explicit bounds check. Add safety guard for type safety.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-29T04:58:43.567374+09:00","updated_at":"2025-12-29T06:03:57.973943+09:00","closed_at":"2025-12-29T06:03:57.973943+09:00","close_reason":"Closed","labels":["bugfix","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-nfx","depends_on_id":"guesthouseosaka-bls","type":"blocks","created_at":"2025-12-29T04:59:32.275213+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-ocf","title":"Migrate remaining next-intl translations to Sanity","description":"Migrate static translations that have corresponding Sanity data:\n\n## High Priority\n- **manifest** namespace: Use `siteName` and `siteDescription` from Settings document instead of hardcoded translations\n- **LegalNoticeDialog.title**: Already exists in Sanity `legalNotice.title` field\n\n## Medium Priority  \n- **FAQLayout.meta**: Header content already in Sanity `faqPage.header` - extract title/description for metadata\n- **ContactLayout.meta**: Header content already in Sanity `contactPage.header` - extract title/description for metadata\n\n## Approach\n1. Query existing Sanity fields for metadata (title, description)\n2. Remove corresponding next-intl translations\n3. Update layout files to fetch from Sanity instead of translations\n\n## Notes\n- Keep translations that are truly static UI strings (button labels, aria labels, etc.)\n- Only migrate content that editors should control via CMS","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T00:46:27.967702+09:00","updated_at":"2025-12-29T01:15:50.284431+09:00","closed_at":"2025-12-29T01:15:50.284431+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-p0l","title":"Fix collection.tsx null assertion crash","description":"Line 96 uses getImageDimensions(image.asset!) which crashes if asset is missing. Add null guard before accessing asset.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-29T04:58:43.40308+09:00","updated_at":"2025-12-29T06:03:57.978301+09:00","closed_at":"2025-12-29T06:03:57.978301+09:00","close_reason":"Closed","labels":["bugfix","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-p0l","depends_on_id":"guesthouseosaka-bls","type":"blocks","created_at":"2025-12-29T04:59:32.234967+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-pmo","title":"Migrate contact form fields to Sanity with enum-based configuration","description":"Configure form fields per contact type in Sanity, with optional label overrides.\n\n## Schema Design (Option B - Enum-based)\n\n```typescript\n// In contactType object\nfields[]: {\n  fieldKey: 'name' | 'email' | 'phone' | 'age' | 'gender' | 'nationality' | \n            'date' | 'hour' | 'places' | 'stay_duration' | 'message'  // enum\n  customTitle?: internationalizedArrayString      // override default\n  customDescription?: internationalizedArrayString // override default\n  required: boolean\n}\n```\n\n## Implementation\n\n1. **Update contactType schema**: Add `fields[]` array with enum field selection\n2. **Keep defaults in code**: Field defaults (title, description, placeholder, validation) remain in translations or code\n3. **GROQ query**: Fetch field config per contact type, merge with defaults in component\n4. **Form components**: Read field list from Sanity, render configured fields with overrides\n\n## Field Types to Support\n- `name` - Text input\n- `email` - Email input  \n- `phone` - Phone input (optional)\n- `age` - Number input\n- `gender` - Select (male/female)\n- `nationality` - Text input\n- `date` - Date picker (tour date / move-in date)\n- `hour` - Time picker (tour hour)\n- `places` - Multi-select houses\n- `stay_duration` - Select duration\n- `message` - Textarea\n\n## Benefits\n- Editors can configure which fields appear per form type\n- Override labels when needed (e.g., 'Tour date' vs 'Move-in date')\n- Field order controlled via array order in Studio\n- No new document types needed\n\n## Migration Steps\n1. Add fields config to existing contactTypes in schema\n2. Update GROQ queries to fetch field config\n3. Refactor form components to be data-driven\n4. Populate Sanity with current field configurations\n5. Remove hardcoded field lists from components","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-29T00:56:10.117736+09:00","updated_at":"2025-12-29T12:18:13.184127+09:00","close_reason":"Closed","deleted_at":"2025-12-29T12:18:13.184127+09:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"guesthouseosaka-rn4","title":"Responsive house pricing: stack label and content on mobile","description":"Current pricing table has label and content side-by-side, which is cramped on mobile.\n\n**Solution:**\n- Desktop (md+): Keep current 2-column table layout (label | content)\n- Mobile (\u003cmd): Stack vertically (label on top, content below)\n\n**Current structure:**\n```\n| Label    | Content           |\n| Rent     | ¬•45,000/month ... |\n```\n\n**Mobile layout:**\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Label               ‚îÇ\n‚îÇ Content             ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ Label               ‚îÇ\n‚îÇ Content             ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n**Notes:**\n- Keep existing design and colors\n- Just change layout for readability\n- Use responsive classes (hidden/block at md breakpoint) or CSS grid/flexbox\n\n**Files:**\n- components/house/house-pricing.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T10:04:00.247761+09:00","updated_at":"2025-12-28T19:41:04.931742+09:00","closed_at":"2025-12-28T19:41:04.931742+09:00","close_reason":"Closed"}
{"id":"guesthouseosaka-ro9","title":"Test form validation schemas","description":"Create components/forms/__tests__/schema.test.ts with 20 tests: places, account, date/time validation, derived schemas","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:09.387241+01:00","created_by":"melkir","updated_at":"2025-12-30T01:37:34.237501+01:00","closed_at":"2025-12-30T01:37:34.237501+01:00","close_reason":"Closed","labels":["forms","testing"]}
{"id":"guesthouseosaka-tj1","title":"Test GalleryModal component","description":"Create components/gallery/__tests__/gallery-modal.test.tsx with 10 tests: keyboard navigation, swipe gestures, carousel state, caption display","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:29.546193+01:00","created_by":"melkir","updated_at":"2025-12-30T01:47:03.547978+01:00","closed_at":"2025-12-30T01:47:03.547978+01:00","close_reason":"Closed","labels":["gallery","testing"],"dependencies":[{"issue_id":"guesthouseosaka-tj1","depends_on_id":"guesthouseosaka-10n","type":"blocks","created_at":"2025-12-30T01:26:29.549129+01:00","created_by":"daemon"},{"issue_id":"guesthouseosaka-tj1","depends_on_id":"guesthouseosaka-0sk","type":"blocks","created_at":"2025-12-30T01:26:29.550268+01:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-tlw","title":"Add Sanity array constraints","description":"Add .min(1) validation to house.gallery and house.pricing arrays in sanity/schemaTypes/documents/house.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:50.380734+01:00","created_by":"melkir","updated_at":"2025-12-30T02:12:56.598512+01:00","closed_at":"2025-12-30T02:12:56.598512+01:00","close_reason":"Closed","labels":["sanity","validation"]}
{"id":"guesthouseosaka-tva","title":"Add Sanity format validations","description":"Add postal code regex validation (XXX-XXXX) in address.ts, text length limits on titles","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T01:26:50.517636+01:00","created_by":"melkir","updated_at":"2025-12-30T02:12:56.568207+01:00","closed_at":"2025-12-30T02:12:56.568207+01:00","close_reason":"Closed","labels":["sanity","validation"]}
{"id":"guesthouseosaka-tyv","title":"E2E: Contact \u0026 FAQ pages baseline tests","description":"Test contact page loads with form types, FAQ page loads with accordion, tables render correctly","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:58:02.82017+09:00","updated_at":"2025-12-29T05:43:02.40939+09:00","closed_at":"2025-12-29T05:43:02.40939+09:00","close_reason":"Closed","labels":["e2e","testing"],"dependencies":[{"issue_id":"guesthouseosaka-tyv","depends_on_id":"guesthouseosaka-m97","type":"blocks","created_at":"2025-12-29T04:58:25.934199+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-u32","title":"Cleanup: Remove redundant next-intl content","description":"Phase C.4 - Cleanup redundant next-intl content\n\nAfter front-end components consume Sanity data, remove unused translation keys from `messages/*.json`:\n\n- [ ] Remove `FAQAccordion` namespace (except keys used by non-migrated items)\n- [ ] Remove `ContactNavigation` namespace\n- [ ] Refactor `ContactNav` component to receive contact types as props instead of using `useContactNavigation` hook\n- [ ] Remove `useContactNavigation` hook after ContactNav refactor\n- [ ] Remove house-related content that's now in Sanity\n- [ ] Remove settings-related keys (company name, etc.)\n- [ ] Remove `useHousePhones` hook after phone numbers migrate to Sanity (depends on 0r6)\n- [ ] Remove `FAQCard.subtext` translations after phone notice migrates (depends on 0r6)\n- [ ] Remove page action button translations after CMS migration (depends on aap)\n- [ ] Remove `LegalNoticeDialog` namespace after Privacy Policy migrates (depends on msl)\n- [ ] Run `bun run knip` to detect any remaining unused exports\n\nBlocked by: je9 (front-end must consume Sanity data first)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T20:26:58.328787+09:00","updated_at":"2025-12-28T23:30:42.80611+09:00","closed_at":"2025-12-28T23:30:42.80611+09:00","close_reason":"Closed","dependencies":[{"issue_id":"guesthouseosaka-u32","depends_on_id":"guesthouseosaka-huw","type":"blocks","created_at":"2025-12-21T20:27:33.21937+09:00","created_by":"daemon","metadata":"{}"},{"issue_id":"guesthouseosaka-u32","depends_on_id":"guesthouseosaka-je9","type":"blocks","created_at":"2025-12-21T20:27:33.387106+09:00","created_by":"daemon","metadata":"{}"},{"issue_id":"guesthouseosaka-u32","depends_on_id":"guesthouseosaka-d86","type":"blocks","created_at":"2025-12-23T01:54:56.134586+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-u3x","title":"Extract FormCard wrapper component","description":"Create components/forms/form-card.tsx - shared Card structure (Header/Content/Footer) used by all forms","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T04:59:00.316305+09:00","updated_at":"2025-12-29T07:47:55.99061+09:00","closed_at":"2025-12-29T07:47:55.99061+09:00","close_reason":"Closed","labels":["dry","refactor"],"dependencies":[{"issue_id":"guesthouseosaka-u3x","depends_on_id":"guesthouseosaka-4bb","type":"blocks","created_at":"2025-12-29T04:59:32.49869+09:00","created_by":"daemon"}]}
{"id":"guesthouseosaka-x02","title":"Migrate useContactNavigation hook to Sanity","description":"Consider migrating the useContactNavigation() hook to get contact type labels from Sanity. Currently ContactNav uses translations for tour/move-in/general labels. The ContactPage in Sanity already has contactTypes with PortableText content. Evaluate if moving navigation labels to Sanity makes sense for CMS consistency. Lower priority than useHouseLabels migration.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-28T23:30:28.217227+09:00","updated_at":"2025-12-29T00:00:40.688668+09:00","closed_at":"2025-12-29T00:00:40.688668+09:00","close_reason":"Migrated useContactNavigation hook to Sanity. Added title/description fields to contactType schema, removed obsolete PortableText content field. ContactNav, ContactTypesList, and forms now use title/description from Sanity. Deleted hook and translations."}
